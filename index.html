<!DOCTYPE html>
<html lang="en">

<head>
    <title>IV hnpwa</title>
    <meta charset="utf-8">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <link rel="apple-touch-icon" sizes="120x120" href="/public/logo-120.png">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5, minimal-ui">
    <link rel="shortcut icon" sizes="48x48" href="./public/logo-48.png">
    <meta name="theme-color" content="#005EB8">
    <link rel="manifest" href="./manifest.json">
    <script>
      let __iv__testMode = false;
      function __iv__route() {
        const hash = window.location.hash;
        if (hash === '#test') {
          __iv__testMode = true;
        }
        let url;
        let page = '#top';
        let param = '1';
        if (hash.length > 0) {
          [page, param] = hash.split('/');
          if (param == null) {
            param = '1';
          }
        }
        if (!__iv__testMode) {
          switch (page) {
            case '#top':
              url = 'https://node-hnapi.herokuapp.com/news?page=' + param;
              break;
            case '#new':
              url = 'https://node-hnapi.herokuapp.com/newest?page=' + param;
              break;
            case '#show':
              url = 'https://node-hnapi.herokuapp.com/show?page=' + param;
              break;
            case '#ask':
              url = 'https://node-hnapi.herokuapp.com/ask?page=' + param;
              break;
            case '#job':
              url = 'https://node-hnapi.herokuapp.com/jobs?page=' + param;
              break;
            case '#item':
              url = 'https://node-hnapi.herokuapp.com/item/' + param;
              break;
            case '#user':
              url = 'https://node-hnapi.herokuapp.com/user/' + param;
              break;
            default:
              url = 'https://node-hnapi.herokuapp.com/news?page=1';
              break;
          }
        } else {
          switch (page) {
            case '#top':
              url = './mocks/new.json';
              break;
            case '#new':
              url = './mocks/newest.json';
              break;
            case '#show':
              url = './mocks/show.json';
              break;
            case '#ask':
              url = './mocks/ask.json';
              break;
            case '#job':
              url = './mocks/job.json';
              break;
            case '#item':
              url = './mocks/item.json';
              break;
            case '#user':
              url = './mocks/user.json';
              break;
            default:
              url = './mocks/new.json';
              break;
          }
        }
        return {url, page, param};
      }

      function __iv__fetchData() {
        const {url, page, param} = __iv__route();
        return fetch(url).then((response) => {
          return response.json();
        })
        .catch((e) => {
          return {error: e};
        })
        .then((data) => {
          return {data, page, param};
        });
      }

      __iv__fetchData().then((response) => {
        const event = new Event('dataready');
        event.data = response;
        window.dispatchEvent(event);
      });
      if ('serviceWorker' in navigator) {
        window.addEventListener('load', function() {
          navigator.serviceWorker.register('./sw.js').then(function(registration) {
            // Registration was successful
            //console.log('ServiceWorker registration successful with scope: ', registration.scope);
          }, function(err) {
            // registration failed :(
            //console.log('ServiceWorker registration failed: ', err);
          });
        });
      }
    </script>
    <style>
        body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,Helvetica Neue,sans-serif;font-size:15px;background-color:#f2f3f5;margin:0;padding-top:55px;overflow-y:scroll}a,body{color:#34495e}a{text-decoration:none}.comment .by a,.item-view-header .meta a,.user-view .links a{text-decoration:underline}.header{background-color:#005EB8;position:fixed;z-index:999;height:55px;top:0;left:0;right:0}.news-item,.view{position:relative;background-color:#fff}.header .inner{max-width:800px;box-sizing:border-box;margin:0 auto;padding:15px 5px}.header a{color:hsla(0,0%,100%,.8);line-height:24px;transition:color .15s ease;display:inline-block;vertical-align:middle;font-weight:300;letter-spacing:.075em;margin-right:1.8em}.header a:hover{color:#fff}.header a.router-link-active{color:#fff;font-weight:400}.header a:nth-child(6){margin-right:0}.header .github{color:#fff;font-size:.9em;margin:0;float:right}.logo{font-size:1.5em}@media (max-width:860px){.header .inner{padding:15px 30px}}@media (max-width:600px){.header .inner{padding:15px}.header a{margin-right:1em}.header .github{display:none}}.view{max-width:800px;margin:20px auto;min-height:200px}.news-list{margin-bottom:10px;width:100%}.news-list ul{list-style-type:none;padding:0;margin:0}.news-list-more{margin:20px;padding-bottom:20px;font-size:1.1em;font-weight:700}@media (max-width:600px){.news-list{margin:10px 0}}.news-item{padding:20px 30px 20px 80px;border-bottom:1px solid #eee;line-height:20px}.news-item .score{color:#CE0058;font-size:1.1em;font-weight:700;position:absolute;top:50%;left:0;width:80px;text-align:center;margin-top:-10px}.news-item .meta,.news-item .title{font-size:.85em;color:#727272;display:block}.news-item .title a{font-size:1.2em}.news-item .meta a,.news-item .title a{color:#727272;text-decoration:underline;display:inline-block}.news-item .meta a:hover,.news-item .title a:hover{color:#CE0058}.comment .by,.item-view-header .host,.item-view-header .meta,.item-view-header .meta a{color:#727272}.user-view{background-color:#fff;box-sizing:border-box;padding:2em 3em}.user-view h1{margin:0;font-size:1.5em}.user-view .meta{list-style-type:none;padding:0}.user-view .label{display:inline-block;min-width:4em}.item-view-header{background-color:#fff;padding:1.8em 2em 1em;box-shadow:0 1px 2px rgba(0,0,0,.1)}.item-view-header h1{display:inline;font-size:1.5em;margin:0 .5em 0 0}.item-view-comments{background-color:#fff;margin-top:10px;padding:0 2em .5em}.item-view-comments-header{margin:0;font-size:1.1em;padding:1em 0;position:relative}.comment-children{list-style-type:none;padding:0;margin:0}@media (max-width:600px){.item-view-header h1{font-size:1.25em}}.comment-children .comment-children{margin-left:1.5em}.comment{border-top:1px solid #eee;position:relative}.comment .by,.comment .text,.comment .toggle{font-size:.9em;margin:1em 0}.comment .by a{color:#727272}.comment .text{overflow-wrap:break-word}.comment .text a:hover{color:#CE0058}.comment .text pre{white-space:pre-wrap}.comment .toggle{background-color:#fffbf2;padding:.3em .5em;border-radius:4px}.comment .toggle a{color:#727272;cursor:pointer}.comment .toggle.open{padding:0;background-color:transparent;margin-bottom:-.5em}
    </style>
</head>

<body>
    <div id="root"></div>

    <script type="text/javascript" src="hnpwa.js"></script>
</body>
</html>